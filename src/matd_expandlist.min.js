/*
matd expanded list

Javascript / jQuery plugin to create a Material Design expanded list

Created: 5/17/2019
Author: Chris Ash
License: MIT License

*/
!function(t){t.matd_expandlist={id:"",list:[],templateString:'<div id="mtd_${id}" class="ex_container flex-base justify-center"><div class="ex_inner">${rows}</div></div>',templateRowString:'<div class="ex_row_frame" aria-expanded="false"><div class="ex_hdr_cont flex-base justify-center flex-align-items-cntr" tabindex="0" role="button" aria-expanded="false"><div class="ex_headings flex-base"><div class="marg_z_block typograph ex_head">${heading}</div><div class="marg_z_block typograph ex_sec_head">${secondary_heading}</div></div><div class="ex_svg_cont" tabindex="-1" role="button" aria-hidden="true"><span class="svg_ctrl"><svg class="svg_style" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path><path fill="none" d="M0 0h24v24H0z"></path></svg></span><span class="svg_frame"></span></div></div><div class="ex_det_con" aria-hidden="true"><div class="flex-base"><div class="w_100p"><div class="flex-base det_pad"><div class="marg_z_block typograph">${details}</div></div></div></div></div></div>',existing_id:"",orig_input:[]};var e={id:"",list:[],templateString:'<div id="mtd_${id}" class="ex_container flex-base justify-center"><div class="ex_inner">${rows}</div></div>',templateRowString:'<div class="ex_row_frame" aria-expanded="false"><div class="ex_hdr_cont flex-base justify-center flex-align-items-cntr" tabindex="0" role="button" aria-expanded="false"><div class="ex_headings flex-base"><div class="marg_z_block typograph ex_head">${heading}</div><div class="marg_z_block typograph ex_sec_head">${secondary_heading}</div></div><div class="ex_svg_cont" tabindex="-1" role="button" aria-hidden="true"><span class="svg_ctrl"><svg class="svg_style" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path><path fill="none" d="M0 0h24v24H0z"></path></svg></span><span class="svg_frame"></span></div></div><div class="ex_det_con" aria-hidden="true"><div class="flex-base"><div class="w_100p"><div class="flex-base det_pad"><div class="marg_z_block typograph">${details}</div></div></div></div></div></div>',existing_id:"",orig_input:[]};t.extend(t.fn,{matd_expandlist:function(){var d=arguments[0],n=[].slice.call(arguments).slice(1);if(a[d])return a[d].apply(this,n);var s=i.checkAPI(t.matd_expandlist,e,a);if(t.matd_expandlist=s.local,a=s.API,d&&(s=i.checkAPI(t.matd_expandlist,d,a),t.matd_expandlist=s.local,a=s.API),""==t.matd_expandlist.id)if(""!=t(this).attr("id"))t.matd_expandlist.id=t(this).attr("id");else{i.counter++;var r="r"+(new Date).getTime()+"r"+i.counter;t.matd_expandlist.id=r,t(this).attr("id",r)}i.startup.apply(this)}});for(var a={debug:function(){console.log("[debug]",t.matd_expandlist)}},i={counter:1,types:["checkbox"],startup:function(){""!=t.matd_expandlist.templateString?0==t("#mtd_"+t.matd_expandlist.id).length?(i.trigger_evt(t.matd_expandlist.id,"init",""),i.place_ctrl(i.make_html()),i.assign_event(),i.trigger_evt(t.matd_expandlist.id,"started","")):console.log("[matd_expandlist] id: "+t.matd_expandlist.id+" is already in place in the DOM. Control not added."):console.log("[matd_expandlist] Control Template may not be blank")},check_target_type:function(){var e=t("#"+t.matd_expandlist.id);if("input"==e[0].nodeName.toLowerCase()){t.matd_expandlist.preserve_input=!0,t.matd_expandlist.existing_id=""+t.matd_expandlist.id;for(var a=0;a<e[0].attributes.length;a++){var d=e[0].attributes[a];t.matd_expandlist.orig_input.push(d)}var n=e.parent();if(""!=n.attr("id")&&n.attr("id"))t.matd_expandlist.id=n.attr("id");else{i.counter++;var s="r"+(new Date).getTime()+"r"+i.counter;n.attr("id",s),t.matd_expandlist.id=s}}},add_hash_hex:function(t){return null!=(/^[a-f\d]{2}[a-f\d]{2}[a-f\d]{2}$/i.exec(t)||/^[a-f\d]{3}$/i.exec(t))&&(t="#"+t),t},make_html:function(){t.matd_expandlist.disp_rows=[],t.matd_expandlist.rows="";var e=t.matd_expandlist.list,a=function(e){return e.forEach(function(e){var d=function(t,e,a){return 0==t.hasOwnProperty(e)&&(t[e]=a),t};if(e=d(e,"secondary_heading",""),e=d(e,"override_css",""),"object"==typeof(e=d(e,"details","")).details){var n=a(e.details),s={id:"sub_"+t.matd_expandlist.id,rows:""};n.forEach(function(t){s.rows+=t.row_html}),e.details=i.prp_ct(t.matd_expandlist.templateString,s)}e.row_html=i.prp_ct(t.matd_expandlist.templateRowString,e)}),e};return a(e).forEach(function(e){t.matd_expandlist.rows+=e.row_html}),i.prp_ct(t.matd_expandlist.templateString,t.matd_expandlist)},place_ctrl:function(e){if(0==t("#mtd_"+t.matd_expandlist.id).length)if(""!=t.matd_expandlist.existing_id){t("#"+t.matd_expandlist.id).prepend(e);var a=t("#mtd_"+t.matd_expandlist.id).attr("class");t("#"+t.matd_expandlist.existing_id).clone(!0,!0).attr("id",t.matd_expandlist.existing_id+"new").addClass(a).attr("tabIndex","0").attr("autocomplete","on").attr("aria-invalid","false").attr("aria-required","false").insertBefore("#mtd_"+t.matd_expandlist.id),t("#"+t.matd_expandlist.existing_id).remove(),t("#mtd_"+t.matd_expandlist.id).remove(),t("#"+t.matd_expandlist.existing_id+"new").attr("id",t.matd_expandlist.existing_id)}else t("#"+t.matd_expandlist.id).html(e);else console.log("[matd_expandlist] id: mtd_"+t.matd_expandlist.id+" is already in place in the DOM. Control not added.")},assign_event:function(){var e=t("#mtd_"+t.matd_expandlist.id+" .ex_hdr_cont");""!=t.matd_expandlist.existing_id&&(e=t("#"+t.matd_expandlist.existing_id+" .ex_hdr_cont")),t(e).on("click",function(e){var a=function(t){var e,a=function(t){"true"==t.attr("aria-expanded")?(t.attr("aria-expanded","false"),t.removeClass("active")):(t.attr("aria-expanded","true"),t.addClass("active"))};"true"==(e=t).attr("aria-expanded")?e.find(".ex_det_con").attr("style","min-height: 0px; height: 0px; transition-duration: 224ms;"):e.find(".ex_det_con").attr("style","min-height: 0px; height: "+e.find(".ex_det_con > div").height()+"px; transition-duration: 224ms;"),a(t),a(t.find(".ex_hdr_cont")),function(t){t.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){})}(t.find(".ex_det_con"))},d=t(this).parent(".ex_row_frame");0==d.hasClass("active")&&a(t(this).parents(".ex_inner").find("div.ex_row_frame[aria-expanded=true]")),a(d),i.trigger_evt(t.matd_expandlist.id,"row_clicked",d,e)})},trigger_evt:function(e,a,i){t("#"+e).trigger(a,i)},checkAPI:function(t,e,a){var d={};for(var n in t)if(d[n]=t[n],e.hasOwnProperty(n))if("object"==typeof d[n])if(Array.isArray(d[n])&&Array.isArray(e[n])){d[n]=[];for(var s=e[n],r=d[n],l=0;l<e[n].length;l++){var o=s[l];r.push(o)}}else"string"==typeof e[n]&&Array.isArray(d[n])?d[n].push(e[n]):d[n]=e[n];else d[n]=e[n];return i.each(a,function(t,i){null!=e[t]&&(a[t]=e[t])}),{local:d,API:a}},prp_ct:function(t,e,a){var i=/\${([^\}]+)}/i,d=0;a&&(e=a);try{do{var n=i.exec(t);if(null!=n&&n.length>1){var s=n[1];t=new Function("_tmpl","_newval","return _tmpl.replace(/\\${"+s+"}/ig, _newval);")(t,e[s]),d++}else d=10}while(d<10)}catch(t){console.log("[prp_ct] error processing template = "+t)}return t},each:function(t,e){var a,d=0;if(i.isArrayLike(t))for(a=t.length;d<a&&!1!==e.call(t[d],d,t[d]);d++);else for(d in t)if(!1===e.call(t[d],d,t[d]))break;return t},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i.class2type[i.class2type.toString.call(t)]||"object":typeof t},class2type:{},isWindow:function(t){return null!=t&&t===t.window},isArrayLike:function(t){var e=!!t&&"length"in t&&t.length,a=i.type(t);return"function"!==a&&!i.isWindow(t)&&("array"===a||0===e||"number"==typeof e&&e>0&&e-1 in t)}},d="Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),n=d.length,s=0;s<n;s++){var r=d[s];i.class2type["[object "+r+"]"]=r.toLowerCase()}}(jQuery);